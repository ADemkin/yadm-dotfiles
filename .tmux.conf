# To get hex codes for iTerm2 use xxd -psd
# mouse e mode (tmux 2.1 and above)
set -g mouse off
set -g default-terminal "tmux-256color"
set -as terminal-overrides ",*:Tc"
set -as terminal-overrides ',*:Smulx=\E[4::%p1%dm'  # undercurl support
set -as terminal-overrides ',*:Setulc=\E[58::2::::%p1%{65536}%/%d::%p1%{256}%/%{255}%&%d::%p1%{255}%&%d%;m'  # underscore colours - needs tmux-3.0
set -ga terminal-features ",alacritty:usstyle"
set -sa terminal-features ',alacritty:RGB' # Makes sure that colors in tmux are the same as without tmux


set -g renumber-windows on

set -sg escape-time 10
set -g focus-events on

set -g base-index 1

# Enamble Vi mode
set -g mode-keys vi

# Set history limit
set -g history-limit 131072

# Move over panes
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Rename windows
set-window-option -g automatic-rename on

# Theme
set -g status-interval 1
set -g status-justify centre
set -g status-left-length 200
set -g status-right-length 200

# Gruvbox
gruvbox_black="#282828"
gruvbox_white="#ebdbb2"
gruvbox_green="#b8bb26"
gruvbox_blue="#83a598"
gruvbox_purple="#d3869b"
gruvbox_red="#fb4934"
gruvbox_yellow="#fabd2f"
gruvbox_orange="#fe8019"
gruvbox_gray="#a89984"
gruvbox_darkgray="#3c3836"
gruvbox_lightgray="#504945"
gruvbox_inactivegray="#7c6f64"

accent="${gruvbox_green}"

# Lualine-like sections
colour_a="#[bg=${gruvbox_gray},fg=${gruvbox_black}]"
colour_b="#[bg=${gruvbox_lightgray},fg=${gruvbox_white}]"
colour_c="#[bg=${gruvbox_darkgray},fg=${gruvbox_gray}]"
colour_d="#[fg=${gruvbox_inactivegray},bg=${gruvbox_black}]"

# --- Status ---
set -g status-style "bg=${gruvbox_black},fg=${gruvbox_white}"
set -g  status-left  "${colour_a} #S ${colour_b} #(whoami) ${colour_c} #(. ~/layout.sh) ${colour_d}"
set -g  status-right ""
set -ag status-right  "${colour_d} #{ping} ms "
set -ag status-right  "${colour_c} #(. ~/battery.sh) "
set -ag status-right  "${colour_b} %d.%m.%y %a "
set -ag status-right  "${colour_a} %R "
set -ag status-right  "${reset}"

set -g window-status-format           " #I #W "
set -g window-status-current-format   " #I #W "
set -g window-status-separator " "

set -g window-status-style         "fg=${gruvbox_gray},bg=${gruvbox_darkgray}"
set -g window-status-last-style    "fg=${accent},bg=${gruvbox_lightgray}"
set -g window-status-current-style "fg=${gruvbox_black},bg=${accent}"
set -g window-status-bell-style    "fg=${gruvbox_black},bg=${gruvbox_orange}"

# --- Panes / display ---
set -g pane-border-style         "bg=default,fg=${gruvbox_inactivegray}"
set -g pane-active-border-style  "bg=default,fg=${accent}"
set -g display-panes-colour        "${gruvbox_black}"
set -g display-panes-active-colour "${gruvbox_inactivegray}"


# Copypaste mode
set-window-option -g mode-keys vi

# Reload the config by C-b r
bind r source-file ~/.tmux.conf \; display "Config reloaded!"

# Open terminal history in vim
bind-key C-e run-shell "~/edit-tmux-output.sh"

# Cycle through last windows by C-b C-a
bind-key C-a last-window

# C-Tab to cycle through panes
bind -r Tab select-pane -t :.+

# Easy split
bind v split-window -h -c "#{pane_current_path}"
bind s split-window -v -c "#{pane_current_path}"

# Run gping.sh when C-b g is pressed
bind-key g run-shell "~/gping.sh"

# TmuxPluginManager
# clone it first:
# % git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm
# then use hotkeys:
# prefix I - install
# prefix U - update
set -g @plugin "tmux-plugins/tpm"

# Ping
set -g @plugin "ayzenquwe/tmux-ping"
set -g @ping_colorize false

# VimTmuxNavigator
set -g @plugin "aserowy/tmux.nvim"

# navigation
set -g @tmux-nvim-navigation true
set -g @tmux-nvim-navigation-cycle false
set -g @tmux-nvim-navigation-keybinding-left "C-h"
set -g @tmux-nvim-navigation-keybinding-down "C-j"
set -g @tmux-nvim-navigation-keybinding-up "C-k"
set -g @tmux-nvim-navigation-keybinding-right "C-l"

# resize
set -g @tmux-nvim-resize true
set -g @tmux-nvim-resize-step-x 3
set -g @tmux-nvim-resize-step-y 3
set -g @tmux-nvim-resize-keybinding-left "M-h"
set -g @tmux-nvim-resize-keybinding-down "M-j"
set -g @tmux-nvim-resize-keybinding-up "M-k"
set -g @tmux-nvim-resize-keybinding-right "M-l"

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run "~/.tmux/plugins/tpm/tpm"
